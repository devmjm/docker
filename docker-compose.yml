version: "3.2"
services:
  registry:
    image: "springboot.azurecr.io/spring/docker_registry"
    deploy:
      mode: replicated
      replicas: 2
      restart_policy:
        condition: on-failure
        delay: 10s
        max_attempts: 3
        placement:
          constraints: [node.role == manager]
    ports:
      - "8600:8600"
  # configuration:
    # build: "./infrastructure/config"
    # ports:
      # - "8601:8601"
    # environment:
      # - EUREKA_SERVICE_URL=http://registry:8600
      # - CONFIG_REPOSITORY=/repository/config-repository/
    # depends_on:
      # - registry
  # admin:
    # build: "./infrastructure/admin"
    # ports:
      # - "8602:8602"
    # environment:
      # - EUREKA_SERVICE_URL=http://registry:8600
    # depends_on:
      # - registry
